#!/usr/bin/env luajit

ALL_SPECIES = {
  ["Bulbasaur"] = 0;
  ["Ivysaur"] = 0;
  ["Venusaur"] = 0;
  ["Charmander"] = 0;
  ["Charmeleon"] = 0;
  ["Charizard"] = 0;
  ["Squirtle"] = 0;
  ["Wartortle"] = 0;
  ["Blastoise"] = 0;
  ["Caterpie"] = 0;
  ["Metapod"] = 0;
  ["Butterfree"] = 0;
  ["Weedle"] = 0;
  ["Kakuna"] = 0;
  ["Beedrill"] = 0;
  ["Pidgey"] = 0;
  ["Pidgeotto"] = 0;
  ["Pidgeot"] = 0;
  ["Rattata"] = 0;
  ["Raticate"] = 0;
  ["Spearow"] = 0;
  ["Fearow"] = 0;
  ["Ekans"] = 0;
  ["Arbok"] = 0;
  ["Pikachu"] = 0;
  ["Raichu"] = 0;
  ["Sandshrew"] = 0;
  ["Sandslash"] = 0;
  ["Nidoran♀"] = 0;
  ["Nidorina"] = 0;
  ["Nidoqueen"] = 0;
  ["Nidoran♂"] = 0;
  ["Nidorino"] = 0;
  ["Nidoking"] = 0;
  ["Clefairy"] = 0;
  ["Clefable"] = 0;
  ["Vulpix"] = 0;
  ["Ninetales"] = 0;
  ["Jigglypuff"] = 0;
  ["Wigglytuff"] = 0;
  ["Zubat"] = 0;
  ["Golbat"] = 0;
  ["Oddish"] = 0;
  ["Gloom"] = 0;
  ["Vileplume"] = 0;
  ["Paras"] = 0;
  ["Parasect"] = 0;
  ["Venonat"] = 0;
  ["Venomoth"] = 0;
  ["Diglett"] = 0;
  ["Dugtrio"] = 0;
  ["Meowth"] = 0;
  ["Persian"] = 0;
  ["Psyduck"] = 0;
  ["Golduck"] = 0;
  ["Mankey"] = 0;
  ["Primeape"] = 0;
  ["Growlithe"] = 0;
  ["Arcanine"] = 0;
  ["Poliwag"] = 0;
  ["Poliwhirl"] = 0;
  ["Poliwrath"] = 0;
  ["Abra"] = 0;
  ["Kadabra"] = 0;
  ["Alakazam"] = 0;
  ["Machop"] = 0;
  ["Machoke"] = 0;
  ["Machamp"] = 0;
  ["Bellsprout"] = 0;
  ["Weepinbell"] = 0;
  ["Victreebel"] = 0;
  ["Tentacool"] = 0;
  ["Tentacruel"] = 0;
  ["Geodude"] = 0;
  ["Graveler"] = 0;
  ["Golem"] = 0;
  ["Ponyta"] = 0;
  ["Rapidash"] = 0;
  ["Slowpoke"] = 0;
  ["Slowbro"] = 0;
  ["Magnemite"] = 0;
  ["Magneton"] = 0;
  ["Farfetch'd"] = 0;
  ["Doduo"] = 0;
  ["Dodrio"] = 0;
  ["Seel"] = 0;
  ["Dewgong"] = 0;
  ["Grimer"] = 0;
  ["Muk"] = 0;
  ["Shellder"] = 0;
  ["Cloyster"] = 0;
  ["Gastly"] = 0;
  ["Haunter"] = 0;
  ["Gengar"] = 0;
  ["Onix"] = 0;
  ["Drowzee"] = 0;
  ["Hypno"] = 0;
  ["Krabby"] = 0;
  ["Kingler"] = 0;
  ["Voltorb"] = 0;
  ["Electrode"] = 0;
  ["Exeggcute"] = 0;
  ["Exeggutor"] = 0;
  ["Cubone"] = 0;
  ["Marowak"] = 0;
  ["Hitmonlee"] = 0;
  ["Hitmonchan"] = 0;
  ["Lickitung"] = 0;
  ["Koffing"] = 0;
  ["Weezing"] = 0;
  ["Rhyhorn"] = 0;
  ["Rhydon"] = 0;
  ["Chansey"] = 0;
  ["Tangela"] = 0;
  ["Kangaskhan"] = 0;
  ["Horsea"] = 0;
  ["Seadra"] = 0;
  ["Goldeen"] = 0;
  ["Seaking"] = 0;
  ["Staryu"] = 0;
  ["Starmie"] = 0;
  ["Mr. Mime"] = 0;
  ["Scyther"] = 0;
  ["Jynx"] = 0;
  ["Electabuzz"] = 0;
  ["Magmar"] = 0;
  ["Pinsir"] = 0;
  ["Tauros"] = 0;
  ["Magikarp"] = 0;
  ["Gyarados"] = 0;
  ["Lapras"] = 0;
  ["Ditto"] = 0;
  ["Eevee"] = 0;
  ["Vaporeon"] = 0;
  ["Jolteon"] = 0;
  ["Flareon"] = 0;
  ["Porygon"] = 0;
  ["Omanyte"] = 0;
  ["Omastar"] = 0;
  ["Kabuto"] = 0;
  ["Kabutops"] = 0;
  ["Aerodactyl"] = 0;
  ["Snorlax"] = 0;
  ["Articuno"] = 0;
  ["Zapdos"] = 0;
  ["Moltres"] = 0;
  ["Dratini"] = 0;
  ["Dragonair"] = 0;
  ["Dragonite"] = 0;
  ["Mewtwo"] = 0;
}

RED_EXCLUSIVES = {
	["Ekans"] = 0;
	["Arbok"] = 0;
	["Oddish"] = 0;
	["Gloom"] = 0;
	["Vileplume"] = 0;
	["Mankey"] = 0;
	["Primeape"] = 0;
	["Growlithe"] = 0;
	["Arcanine"] = 0;
	["Scyther"] = 0;
	["Electabuzz"] = 0;
};

BLUE_EXCLUSIVES = {
	["Sandshrew"] = 0;
	["Sandslash"] = 0;
	["Vulpix"] = 0;
	["Ninetales"] = 0;
	["Meowth"] = 0;
	["Persian"] = 0;
	["Bellsprout"] = 0;
	["Weepinbell"] = 0;
	["Victreebel"] = 0;
	["Magmar"] = 0;
	["Pinsir"] = 0;
};

STARTERS = {
	["Bulbasaur"] = 0;
	["Ivysaur"] = 0;
	["Venusaur"] = 0;
	["Charmander"] = 0;
	["Charmeleon"] = 0;
	["Charizard"] = 0;
	["Squirtle"] = 0;
	["Wartortle"] = 0;
	["Blastoise"] = 0;
}

PARTY_SIZE = 6

function pick(t)
	-- assemble array of keys
	local keys, i = {}, 1
	for k, _ in pairs(t) do
		keys[i] = k
		i = i + 1
	end

	-- return random key and value
	i = math.random(1, #keys)
	return keys[i], t[keys[i]]
end

function generateParty(versions)
	-- start by copying all species to pool
	local pool = {}
	for k, v in pairs(ALL_SPECIES) do
		pool[k] = v
	end

	-- eliminate species unobtainable due to version
	local red, blue = false, false
	for _, version in ipairs(versions) do
		if version == "red" then
			red = true
		elseif version == "blue" then
			blue = true
    else
      print("invalid version: " .. version)
		end
	end
	if red then
		for species in pairs(BLUE_EXCLUSIVES) do
			pool[species] = nil
		end
	end
	if blue then
		for species in pairs(RED_EXCLUSIVES) do
			pool[species] = nil
		end
	end

	-- assemble random party from pool
	local party = {}
	for i = 1, PARTY_SIZE, 1 do
		species = pick(pool)
		party[i] = species

		-- remove species from pool, and other starters if species is a starter
		if STARTERS[species] then
			for species in pairs(STARTERS) do
				pool[species] = nil
			end
		else
			pool[species] = nil
		end
	end
	return party
end

function main()
	math.randomseed(os.time())
  if #arg < 1 then
    print("usage: catchrate version ...")
  else
		for _, species in ipairs(generateParty(arg)) do
			print(species)
		end
  end
end

main()
